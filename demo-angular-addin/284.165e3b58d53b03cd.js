"use strict";(self.webpackChunkcustom_template_builder=self.webpackChunkcustom_template_builder||[]).push([[284],{8284:(N,d,o)=>{o.r(d),o.d(d,{HtmlEditorComponent:()=>m,default:()=>F});var l=o(4755),h=o(4128),u=o(9751),f=o(4004),v=o(590),c=o(5577),p=o(9300),g=o(5698),E=o(2550),t=o(9523),y=o(3396),C=o(7579),S=o(2340);let T=(()=>{class i{constructor(){this.loaded=!1,this.loadingFinishedSub$=new C.x,this.loadingFinished$=this.loadingFinishedSub$.asObservable()}initialize(){const e=S.N.monacoBaseUrl;if("object"==typeof window.monaco)return void this.finishLoading();const n=()=>{window.require.config({paths:{vs:`${e}`}}),window.require(["vs/editor/editor.main"],()=>{this.finishLoading()})};if(window.require)n();else{const a=document.createElement("script");a.type="text/javascript",a.src=`${e}/loader.js`,a.addEventListener("load",n),document.body.appendChild(a)}}finishLoading(){this.loaded=!0,this.loadingFinishedSub$.next()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var x=o(6202);const $=["editorContainer"];function M(i,r){if(1&i&&(t.TgZ(0,"div",8),t._uU(1),t.qZA()),2&i){const e=r.ngIf;t.xp6(1),t.hij(" ",e," ")}}let m=(()=>{class i{constructor(e,n,a){this.router=e,this.monacoEditorService=n,this.searchService=a,this.fileName$=this.router.queryParamMap.pipe((0,f.U)(s=>{const H=s.get("data");return(0,E.sW)(H)?.htmlTemplateName})),this.monacoEditorService.initialize()}ngAfterViewInit(){const e=this.initMonaco(),n=this.loadTemplateFile();(0,h.D)([e,n]).subscribe(([a,s])=>{this._editor.setValue(s)})}initMonaco(){return this.monacoEditorService.loaded?this.createMonacoEditor():this.monacoEditorService.loadingFinished$.pipe((0,v.P)(),(0,c.z)(()=>this.createMonacoEditor()))}createMonacoEditor(){return new u.y(e=>{this._editor=monaco.editor.create(this._editorContainer.nativeElement,{language:"html"}),e.next(),e.complete()})}loadTemplateFile(){return this.fileName$.pipe((0,p.h)(e=>e),(0,g.q)(1),(0,c.z)(e=>this.searchService.loadTemplateFile(e)))}saveTemplate(){const e=this._editor.getValue();Office.context.ui.messageParent(JSON.stringify({content:e}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(y.gz),t.Y36(T),t.Y36(x.o))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ds-html-editor"]],viewQuery:function(e,n){if(1&e&&t.Gf($,7),2&e){let a;t.iGM(a=t.CRH())&&(n._editorContainer=a.first)}},standalone:!0,features:[t.jDz],decls:10,vars:3,consts:[[1,"flex","flex-col","h-screen"],[1,"flex","p-4","shadow","md:shadow-lg"],["class","font-bold",4,"ngIf"],[1,"bg-brand-primary","px-2","py-1","rounded","ml-auto"],[1,"text-gray-100","text-sm",3,"click"],[1,"flex-auto","overflow-y-auto"],[1,"h-screen","rounded-lg"],["editorContainer",""],[1,"font-bold"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,M,2,1,"div",2),t.ALo(3,"async"),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return n.saveTemplate()}),t._uU(6,"Save"),t.qZA()()(),t.TgZ(7,"div",5),t._UZ(8,"div",6,7),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngIf",t.lcZ(3,1,n.fileName$)))},dependencies:[l.Ov,l.O5],encapsulation:2}),i})();const F=m}}]);