"use strict";(self.webpackChunkcustom_template_builder=self.webpackChunkcustom_template_builder||[]).push([[903],{3903:(Z,d,i)=>{i.r(d),i.d(d,{HtmlEditorComponent:()=>f,default:()=>H});var c=i(4755),u=i(4128),v=i(9751),p=i(4004),g=i(590),m=i(5577),S=i(9300),E=i(5698),h=i(2550),e=i(9523),y=i(3396),T=i(7579),C=i(2340);let $=(()=>{class o{constructor(){this.loaded=!1,this.loadingFinishedSub$=new T.x,this.loadingFinished$=this.loadingFinishedSub$.asObservable()}initialize(){const t=C.N.monacoBaseUrl;if("object"==typeof window.monaco)return void this.finishLoading();const n=()=>{window.require.config({paths:{vs:`${t}`}}),window.require(["vs/editor/editor.main"],()=>{this.finishLoading()})};if(window.require)n();else{const r=document.createElement("script");r.type="text/javascript",r.src=`${t}/loader.js`,r.addEventListener("load",n),document.body.appendChild(r)}}finishLoading(){this.loaded=!0,this.loadingFinishedSub$.next()}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var x=i(9646),F=i(3144);let M=(()=>{class o{constructor(t){this.http=t}loadTemplateFile(t){if(!t)throw"No template file available";const n=(0,h.sW)("dsTemplates");if(n){const l=n[t];if(l)return(0,x.of)(l)}return this.http.get(`https://master.boarddecisions.com/templates/0/${t}`,{responseType:"text"})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(F.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const N=["editorContainer"];function b(o,a){if(1&o&&(e.TgZ(0,"div",8),e._uU(1),e.qZA()),2&o){const t=a.ngIf;e.xp6(1),e.hij(" ",t," ")}}let f=(()=>{class o{constructor(t,n,r){this.router=t,this.monacoEditorService=n,this.searchService=r,this.fileName$=this.router.queryParamMap.pipe((0,p.U)(s=>{const l=s.get("data");return(0,h.sW)(l)?.htmlTemplateName})),this.monacoEditorService.initialize()}ngAfterViewInit(){const t=this.initMonaco(),n=this.loadTemplateFile();(0,u.D)([t,n]).subscribe(([r,s])=>{this._editor.setValue(s)})}initMonaco(){return this.monacoEditorService.loaded?this.createMonacoEditor():this.monacoEditorService.loadingFinished$.pipe((0,g.P)(),(0,m.z)(()=>this.createMonacoEditor()))}createMonacoEditor(){return new v.y(t=>{this._editor=monaco.editor.create(this._editorContainer.nativeElement,{language:"html"}),t.next(),t.complete()})}loadTemplateFile(){return this.fileName$.pipe((0,S.h)(t=>t),(0,E.q)(1),(0,m.z)(t=>this.searchService.loadTemplateFile(t)))}saveTemplate(){const t=this._editor.getValue();Office.context.ui.messageParent(JSON.stringify({content:t}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(y.gz),e.Y36($),e.Y36(M))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ds-html-editor"]],viewQuery:function(t,n){if(1&t&&e.Gf(N,7),2&t){let r;e.iGM(r=e.CRH())&&(n._editorContainer=r.first)}},standalone:!0,features:[e.jDz],decls:10,vars:3,consts:[[1,"flex","flex-col","h-screen"],[1,"flex","p-4","shadow","md:shadow-lg"],["class","font-bold",4,"ngIf"],[1,"bg-brand-primary","px-2","py-1","rounded","ml-auto"],[1,"text-gray-100","text-sm",3,"click"],[1,"flex-auto","overflow-y-auto"],[1,"h-screen","rounded-lg"],["editorContainer",""],[1,"font-bold"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,b,2,1,"div",2),e.ALo(3,"async"),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return n.saveTemplate()}),e._uU(6,"Save"),e.qZA()()(),e.TgZ(7,"div",5),e._UZ(8,"div",6,7),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,n.fileName$)))},dependencies:[c.Ov,c.O5],encapsulation:2}),o})();const H=f}}]);